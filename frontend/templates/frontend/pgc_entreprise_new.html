{% extends 'base_dossier.html' %}
{% load static %}
{% block content %}
<section class="py-5">
  <div class="container">

    <h1 class="mb-4">Plan Comptable Général</h1>
    <div id="entreprise" data-id="{{ entreprise.id }}"></div>

    <div class="container">

      <h2>Dossier <span> </span>{{ entreprise_nom }}</h2>
<!--      <h2>Id: <span> </span>{{ entreprise_id }}</h2>-->
      <h2>Id: <span> </span>{{ entreprise.id }}</h2>
    </div>

<div class="d-flex justify-content-between mb-2">
  <div class="pagination">
    <span class="step-links">
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}{% if classe %}&classe={{ classe }}{% endif %}"
            class="btn btn-primary {% if not page_obj.has_previous %}disabled{% endif %}">
            ◀️ Précédent
        </a>
      {% endif %}
    </span>

      <span class="current">
          Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
      </span>
    <span class="step-right">
      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}{% if classe %}&classe={{ classe }}{% endif %}"
            class="btn btn-primary {% if not page_obj.has_next %}disabled{% endif %}">
            Suivant ▶️
        </a>
      {% endif %}
      </span>
  </div>
</div>

      <!-- NAVIGATION RAPIDE -->
      <div class="d-flex gap-2 my-3">
          <!-- Classes comptables -->
            <div>
              <strong>Classes :</strong>
              <button class="btn btn-outline-primary btn-sm jump-class" data-class="1">1</button>
              <button class="btn btn-outline-primary btn-sm jump-class" data-class="2">2</button>
              <button class="btn btn-outline-primary btn-sm jump-class" data-class="3">3</button>
              <button class="btn btn-outline-primary btn-sm jump-class" data-class="4">4</button>
              <button class="btn btn-outline-primary btn-sm jump-class" data-class="5">5</button>
              <button class="btn btn-outline-primary btn-sm jump-class" data-class="6">6</button>
              <button class="btn btn-outline-primary btn-sm jump-class" data-class="7">7</button>
            </div>
      </div>


    <!-----------------TABLE---------------------->
    <div class="row">
    <table class="table table-bordered mt-3"  data-toggle="table" >
        <thead>
            <tr>
                <th>Numéro</th>
                <th>Libellé</th>
<!--                <th>Clients/Fournisseurs</th>-->
                <th>Type</th>
                <th>Origine</th>
                <th>Action</th>
            </tr>
        </thead>
        <tbody>
        {% for e in comptes %}
        <tr>
          <td>{{ e.numero }}</td>
          <td>{{ e.libelle }}</td>
<!--          <td>{{ e.nom }}</td>-->
          <td>{{ e.type_compte }}</td>
          <td>{{ e.origine }}</td>
          <td><Button type="button" class="btn btn-outline-primary">
            <a href="{% url 'update-compte' entreprise.id e.id %}">Modifier</a>
            </Button>
          </td>
        </tr>
        {% endfor %}
        </tbody>
      </table>
    </div>

<div class="d-flex justify-content-between mb-2">
  <div class="pagination">
    <span class="step-links">
      {% if page_obj.has_previous %}
        <a href="?page={{ page_obj.previous_page_number }}{% if classe %}&classe={{ classe }}{% endif %}"
            class="btn btn-primary {% if not page_obj.has_previous %}disabled{% endif %}">
            ◀️ Précédent
        </a>
      {% endif %}
    </span>

      <span class="current">
          Page {{ page_obj.number }} of {{ page_obj.paginator.num_pages }}.
      </span>
    <span class="step-right">
      {% if page_obj.has_next %}
        <a href="?page={{ page_obj.next_page_number }}{% if classe %}&classe={{ classe }}{% endif %}"
            class="btn btn-primary {% if not page_obj.has_next %}disabled{% endif %}">
            Suivant ▶️
        </a>
      {% endif %}
      </span>
  </div>
</div>

<!--
    <div class="d-flex justify-content-between mt-2">
      <button id="prev-btn" class="btn btn-primary">
        ◀️ Précédent
      </button>
      <button id="next-btn" class="btn btn-primary">
        Suivant ▶️
      </button>
    </div>
    -->

  </div>
</section>
<script>
document.querySelectorAll(".jump-class").forEach(btn => {
  btn.addEventListener("click", () => {
    const classe = btn.dataset.class;
    const url = new URL(window.location);
    url.searchParams.set("classe", classe);
    url.searchParams.delete("page"); // reset pagination
    window.location.href = url.toString();
  });
});
</script>

{% endblock content %}
